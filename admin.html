<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
  <style>
    .form-container { padding: 20px; max-width: 400px; margin: auto; }
    input, button { margin: 10px 0; padding: 5px; width: 100%; }
  </style>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
  <script src="https://upload-widget.cloudinary.com/latest/global/all.js"></script>
</head>
<body>
  <div class="form-container">
    <h2>Add Product</h2>
    <input type="text" id="title" placeholder="Product Title"><br>
    <input type="text" id="brand" placeholder="Brand"><br>
    <input type="text" id="description" placeholder="Description"><br>
    <input type="number" id="price" placeholder="Price"><br>
    <button id="upload_widget">Upload Image</button><br>
    <button onclick="addProduct()">Add Product</button>
  </div>

  <script>
    // تمہارا Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyD8pAE_mquNZTUujvEK-1v9xmDsUohdYcQ",
      authDomain: "sharifcom-45d95.firebaseapp.com",
      projectId: "sharifcom-45d95",
      storageBucket: "sharifcom-45d95.firebasestorage.app",
      messagingSenderId: "273914972899",
      appId: "1:273914972899:web:65e17d821111e4ac64d3d6",
      measurementId: "G-GZWZ52NDS1"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Cloudinary Upload Widget
    let imageUrl = '';
    var myWidget = cloudinary.createUploadWidget({
      cloudName: 'dwf3tkkrg',
      uploadPreset: 'Sharif',
      folder: 'products'
    }, (error, result) => {
      if (!error && result && result.event === "success") {
        imageUrl = result.info.secure_url;
        alert('Image Uploaded Successfully! URL: ' + imageUrl);
      } else if (error) {
        alert('Error Uploading Image: ' + error);
      }
    });

    document.getElementById('upload_widget').addEventListener('click', () => {
      myWidget.open();
    });

    // پروڈکٹ Firestore میں اپ لوڈ کرو
    async function addProduct() {
      const title = document.getElementById('title').value;
      const brand = document.getElementById('brand').value;
      const description = document.getElementById('description').value;
      const price = document.getElementById('price').value;

      if (!title || !brand || !description || !price || !imageUrl) {
        alert('Please fill all fields and upload an image!');
        return;
      }

      try {
        await db.collection('products').add({
          title: title,
          brand: brand,
          description: description,
          price: Number(price),
          image: imageUrl,
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        alert('Product Added Successfully!');
        document.getElementById('title').value = '';
        document.getElementById('brand').value = '';
        document.getElementById('description').value = '';
        document.getElementById('price').value = '';
        imageUrl = '';
      } catch (error) {
        alert('Error adding product: ' + error.message);
      }
    }
  </script>
</body>
</html>