<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sharif.com — Ecommerce</title>
  <style>
    :root { --brand: #007bff; --bg: #f5f6f8; --text: #222; --card: #fff; }
    * { box-sizing: border-box; }
    body { margin: 0; background: var(--bg); color: var(--text); font-family: Arial, sans-serif; }
    header { background: var(--brand); color: #fff; padding: 10px; position: sticky; top: 0; }
    .nav { display: flex; align-items: center; gap: 10px; }
    .logo { font-weight: bold; font-size: 20px; }
    .btn { background: #fff; color: var(--brand); border: 0; border-radius: 5px; padding: 8px 15px; cursor: pointer; }
    .btn.ghost { background: transparent; color: #fff; border: 1px solid #fff; }
    .wrap { padding: 15px; max-width: 1200px; margin: 0 auto; }
    .tabs { display: flex; gap: 10px; }
    .tab { padding: 8px; border-radius: 5px; background: #ddd; cursor: pointer; }
    .tab.active { background: var(--brand); color: #fff; }
    .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
    @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } .nav { flex-direction: column; } }
    .card { background: var(--card); border-radius: 5px; padding: 10px; }
    .card img { width: 100%; height: 150px; object-fit: contain; }
    .title { font-weight: bold; margin: 5px 0; }
    .price { font-size: 16px; font-weight: bold; }
    #cartPanel { display: none; position: fixed; top: 0; right: 0; width: 300px; height: 100%; background: #fff; padding: 15px; }
    #orderForm { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); }
    #orderFormContent { background: #fff; padding: 20px; margin: 50px auto; max-width: 400px; border-radius: 5px; }
    .setgrid { display: grid; grid-template-columns: 1fr; gap: 10px; }
    .setgrid input, .setgrid textarea { width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ddd; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
</head>
<body>
  <header>
    <div class="nav">
      <div class="logo" id="storeName">Sharif.com</div>
      <div class="tabs" id="navTabs">
        <div class="tab active" data-page="home">Home</div>
        <div class="tab" data-page="settings">Settings</div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <!-- HOME PAGE -->
    <section id="pageHome" class="page active">
      <h2>Featured Products</h2>
      <div class="grid" id="productsGrid"></div>
    </section>

    <!-- SETTINGS PAGE -->
    <section id="pageSettings" class="page">
      <h2>Store Settings</h2>
      <div class="setgrid">
        <input type="text" placeholder="Store Name" id="setStoreName" value="Sharif.com" />
        <input type="text" placeholder="Currency" id="setCurrency" value="₹" />
        <textarea placeholder="Store Notice" id="setNotice"></textarea>
      </div>
      <button onclick="saveStoreSettings()">Save Store Settings</button>
      <button onclick="resetStoreSettings()">Reset</button>

      <h2>Admin Control Panel</h2>
      <div class="setgrid">
        <input type="text" placeholder="Product Title" id="adminTitle" />
        <input type="text" placeholder="Brand" id="adminBrand" />
        <textarea placeholder="Description" id="adminDescription"></textarea>
        <input type="number" placeholder="Price" id="adminPrice" />
        <input type="file" id="imageInput" accept="image/*" />
        <img id="imagePreview" src="" alt="Preview" style="max-width: 200px; display: none; margin-top: 10px;" />
      </div>
      <button onclick="addProduct()">Add Product</button>

      <h2>Address Book</h2>
      <div class="setgrid">
        <input type="text" placeholder="Name" id="custName" />
        <input type="email" placeholder="Email" id="custEmail" />
        <input type="tel" placeholder="Phone" id="custPhone" />
        <textarea placeholder="Full Address" id="custAddress"></textarea>
      </div>
      <button onclick="saveAddress()">Save Address</button>
      <button onclick="resetAddress()">Reset</button>
    </section>
  </main>

  <div id="cartPanel">
    <h3>Cart</h3>
    <div id="cartItems"></div>
    <button onclick="clearCart()">Clear Cart</button>
    <button onclick="showOrderForm()">Order Now</button>
  </div>

  <div id="orderForm">
    <div id="orderFormContent">
      <h3>Place Your Order</h3>
      <form id="orderFormDetails">
        <input type="text" placeholder="Your Name" name="name" required />
        <input type="email" placeholder="Your Email" name="email" required />
        <input type="tel" placeholder="Your Phone" name="phone" required />
        <textarea placeholder="Full Address" name="address" required></textarea>
        <input type="hidden" name="order_details" id="orderDetails" />
        <input type="hidden" name="order_total" id="orderTotal" />
        <button type="submit">Submit Order</button>
      </form>
      <button onclick="hideOrderForm()">Cancel</button>
    </div>
  </div>

  <script>
    // EmailJS Config
    emailjs.init('DapdU3gPmJ8ymUdD2'); // Your public key

    // State
    let products = JSON.parse(localStorage.getItem('products')) || [];
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    let settings = JSON.parse(localStorage.getItem('settings')) || { storeName: 'Sharif.com', currency: '₹', notice: '' };
    let addresses = JSON.parse(localStorage.getItem('addresses')) || [];

    // DOM Elements
    const pages = document.querySelectorAll('.page');
    const navTabs = document.getElementById('navTabs');
    const productsGrid = document.getElementById('productsGrid');
    const cartPanel = document.getElementById('cartPanel');
    const cartItems = document.getElementById('cartItems');
    const imageInput = document.getElementById('imageInput');
    const imagePreview = document.getElementById('imagePreview');
    const storeName = document.getElementById('storeName');
    const orderForm = document.getElementById('orderForm');
    const orderFormDetails = document.getElementById('orderFormDetails');

    // Navigation
    navTabs.addEventListener('click', (e) => {
      if (e.target.classList.contains('tab')) {
        document.querySelector('.tab.active').classList.remove('active');
        e.target.classList.add('active');
        pages.forEach(p => p.classList.remove('active'));
        document.getElementById(`page${e.target.dataset.page.charAt(0).toUpperCase() + e.target.dataset.page.slice(1)}`).classList.add('active');
      }
    });

    // Render Products on Home Page
    function renderProducts() {
      productsGrid.innerHTML = '';
      products.forEach(p => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <img src="${p.image}" alt="${p.title}">
          <div class="title">${p.title}</div>
          <div class="price">${settings.currency}${p.price}</div>
          <button onclick="addToCart(${products.indexOf(p)})">Add to Cart</button>
          <button onclick="showOrderForm(${products.indexOf(p)})">Order Now</button>
        `;
        productsGrid.appendChild(card);
      });
    }

    // Add Product from Settings
    function addProduct() {
      const title = document.getElementById('adminTitle').value;
      const brand = document.getElementById('adminBrand').value;
      const description = document.getElementById('adminDescription').value;
      const price = Number(document.getElementById('adminPrice').value);
      const file = imageInput.files[0];
      let image = '';

      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          image = e.target.result;
          products.push({ title, brand, description, price, image });
          localStorage.setItem('products', JSON.stringify(products));
          imagePreview.src = image;
          imagePreview.style.display = 'block';
          renderProducts(); // Update Home Page
          alert('Product added to Home Page!');
          clearAdminForm();
        };
        reader.readAsDataURL(file);
      } else if (title && brand && description && price) {
        products.push({ title, brand, description, price, image: 'https://via.placeholder.com/150' });
        localStorage.setItem('products', JSON.stringify(products));
        renderProducts(); // Update Home Page
        alert('Product added to Home Page! (No image)');
        clearAdminForm();
      } else {
        alert('Please fill all fields!');
      }
    }

    function clearAdminForm() {
      document.getElementById('adminTitle').value = '';
      document.getElementById('adminBrand').value = '';
      document.getElementById('adminDescription').value = '';
      document.getElementById('adminPrice').value = '';
      imageInput.value = '';
      imagePreview.style.display = 'none';
    }

    // Cart Functions
    function addToCart(id) {
      const item = cart.find(i => i.id === id);
      if (item) item.qty++; else cart.push({ id, qty: 1 });
      localStorage.setItem('cart', JSON.stringify(cart));
      renderCart();
      toggleCart();
    }
    function removeFromCart(id) {
      cart = cart.filter(i => i.id !== id);
      localStorage.setItem('cart', JSON.stringify(cart));
      renderCart();
    }
    function clearCart() {
      if (confirm('Clear cart?')) {
        cart = [];
        localStorage.setItem('cart', JSON.stringify(cart));
        renderCart();
      }
    }
    function renderCart() {
      cartItems.innerHTML = '';
      let total = 0;
      cart.forEach(item => {
        const p = products[item.id];
        total += p.price * item.qty;
        const line = document.createElement('div');
        line.innerHTML = `${p.title} - ${settings.currency}${p.price} x ${item.qty} = ${settings.currency}${p.price * item.qty} <button onclick="removeFromCart(${item.id})">Remove</button>`;
        cartItems.appendChild(line);
      });
      document.getElementById('cartTotal')?.remove();
      cartItems.insertAdjacentHTML('afterend', `<div id="cartTotal">Total: ${settings.currency}${total}</div>`);
      document.getElementById('orderDetails').value = cart.map(item => `${products[item.id].title} x ${item.qty} = ${settings.currency}${products[item.id].price * item.qty}`).join('\n');
      document.getElementById('orderTotal').value = `${settings.currency}${total}`;
    }
    function toggleCart() {
      cartPanel.style.display = cartPanel.style.display === 'block' ? 'none' : 'block';
    }

    // Order Form Functions
    function showOrderForm(id) {
      orderForm.style.display = 'block';
      if (id !== undefined) {
        const p = products[id];
        document.getElementById('orderDetails').value = `${p.title} = ${settings.currency}${p.price}`;
        document.getElementById('orderTotal').value = `${settings.currency}${p.price}`;
      } else {
        renderCart();
      }
    }
    function hideOrderForm() {
      orderForm.style.display = 'none';
      orderFormDetails.reset();
    }

    // Submit Order
    orderFormDetails.addEventListener('submit', function(e) {
      e.preventDefault();
      const name = this.name.value;
      const email = this.email.value;
      const phone = this.phone.value;
      const address = this.address.value;
      const orderDetails = document.getElementById('orderDetails').value;
      const orderTotal = document.getElementById('orderTotal').value;

      if (name && email && phone && address && orderDetails && orderTotal) {
        emailjs.send('service_hwvi11g', 'template_kp1zovr', {
          to_email: 'your-email@example.com', // Replace with your email
          name: name,
          email: email,
          phone: phone,
          address: address,
          order_details: orderDetails,
          order_total: orderTotal,
          message: `New order placed at ${new Date().toLocaleString()}`
        }).then(() => {
          alert('Order placed and sent to your email!');
          hideOrderForm();
          if (cart.length > 0) {
            cart = [];
            localStorage.setItem('cart', JSON.stringify(cart));
            renderCart();
          }
        }, (err) => {
          console.error('Email failed:', err);
          alert('Order placed, but email failed. Check console.');
        });
      } else {
        alert('Please fill all fields!');
      }
    });

    // Store Settings
    function saveStoreSettings() {
      settings.storeName = document.getElementById('setStoreName').value || 'Sharif.com';
      settings.currency = document.getElementById('setCurrency').value || '₹';
      settings.notice = document.getElementById('setNotice').value;
      localStorage.setItem('settings', JSON.stringify(settings));
      storeName.textContent = settings.storeName;
      alert('Store settings saved!');
      renderProducts();
    }
    function resetStoreSettings() {
      localStorage.removeItem('settings');
      location.reload();
    }

    // Address Book
    function saveAddress() {
      const name = document.getElementById('custName').value;
      const email = document.getElementById('custEmail').value;
      const phone = document.getElementById('custPhone').value;
      const address = document.getElementById('custAddress').value;

      if (name && email && phone && address) {
        const addressData = { name, email, phone, address, time: new Date().toLocaleString() };
        addresses.push(addressData);
        localStorage.setItem('addresses', JSON.stringify(addresses));

        emailjs.send('service_hwvi11g', 'template_kp1zovr', {
          to_email: 'your-email@example.com', // Replace with your email
          name: name,
          email: email,
          phone: phone,
          address: address,
          message: `New address saved at ${addressData.time}`
        }).then(() => {
          alert('Address saved and email sent!');
        }, (err) => {
          console.error('Email failed:', err);
          alert('Address saved, but email failed. Check console.');
        });

        document.getElementById('custName').value = '';
        document.getElementById('custEmail').value = '';
        document.getElementById('custPhone').value = '';
        document.getElementById('custAddress').value = '';
      } else {
        alert('Please fill all fields!');
      }
    }
    function resetAddress() {
      localStorage.removeItem('addresses');
      document.getElementById('custName').value = '';
      document.getElementById('custEmail').value = '';
      document.getElementById('custPhone').value = '';
      document.getElementById('custAddress').value = '';
      alert('Address reset!');
    }

    // Init
    (function() {
      renderProducts(); // Load products on Home Page by default
      storeName.textContent = settings.storeName;
    })();
  </script>
</body>
</html>
