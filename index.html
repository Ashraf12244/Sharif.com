<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sharif.com — Ecommerce</title>
  <style>
    :root{
      --brand:#007bff;
      --brand-dark:#0056b3;
      --bg:#f5f6f8;
      --text:#222;
      --muted:#666;
      --card:#fff;
      --danger:#dc3545;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
    a{color:inherit;text-decoration:none}

    /* Header / Navbar */
    header{background:var(--brand);color:#fff;padding:12px 16px;position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;gap:12px}
    .logo{font-weight:800;font-size:20px;letter-spacing:.2px}
    .search{flex:1;display:flex;gap:8px;max-width:720px;margin:0 12px}
    .search input{flex:1;padding:10px;border:0;border-radius:8px}
    .btn{background:#fff;color:var(--brand);border:0;border-radius:8px;padding:10px 12px;font-weight:700;cursor:pointer}
    .btn.secondary{background:#eef3ff;color:var(--brand)}
    .btn.ghost{background:transparent;color:#fff;border:1px solid rgba(255,255,255,.5)}
    .pill{padding:6px 10px;border-radius:999px;background:#fff;color:var(--brand);font-weight:700}

    /* Layout */
    .bar{display:flex;gap:10px;align-items:center}
    .wrap{padding:16px;max-width:1200px;margin:0 auto}
    .tabs{display:flex;gap:10px;flex-wrap:wrap}
    .tab{padding:8px 12px;border-radius:8px;background:#eaf1ff;color:#1a4fb8;cursor:pointer}
    .tab.active{background:#1a4fb8;color:#fff}

    /* Grid */
    .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
    @media (max-width:1000px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:600px){.grid{grid-template-columns:1fr}}
    .card{background:var(--card);border-radius:12px;box-shadow:0 2px 10px rgba(0,0,0,.08);padding:12px;display:flex;flex-direction:column}
    .card img{width:100%;height:160px;object-fit:contain;background:#fff;border-radius:8px}
    .title{font-weight:700;margin:8px 0 4px}
    .muted{color:var(--muted);font-size:14px}
    .price{font-size:18px;font-weight:800;margin-top:4px}
    .row{display:flex;align-items:center;justify-content:space-between;gap:8px}
    .badges{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px}
    .badge{font-size:12px;background:#eef3ff;color:#1a4fb8;border-radius:999px;padding:4px 8px;font-weight:700}

    /* Panels */
    #cartPanel{position:fixed;right:0;top:0;width:380px;max-width:100%;height:100%;background:#fff;box-shadow:-4px 0 16px rgba(0,0,0,.15);padding:16px;display:none;flex-direction:column;z-index:20}
    .cart-line{display:flex;gap:10px;margin:10px 0}
    .cart-line img{width:64px;height:64px;object-fit:contain;border:1px solid #eee;border-radius:8px}
    .qty{display:flex;align-items:center;gap:6px;margin-top:6px}
    .btn.icon{padding:6px 10px;border:1px solid var(--brand);background:#fff;color:var(--brand)}
    .btn.danger{background:var(--danger);color:#fff}

    /* Pages */
    .page{display:none}
    .page.active{display:block}

    /* Settings */
    .setgrid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    .setgrid input,.setgrid select, textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #ddd;background:#fff}

    /* Footer */
    footer{padding:20px;text-align:center;color:#777}

    /* Responsive Design for Mobile */
    @media (max-width: 768px) {
      header { padding: 8px; }
      .nav { flex-direction: column; gap: 8px; }
      .search { margin: 0; }
      .bar { flex-direction: column; gap: 5px; }
      .grid { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); }
      .card img { height: 120px; }
      #cartPanel { width: 100%; }
      .wrap { padding: 8px; }
    }
</style>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
  <!-- Cloudinary Widget -->
  <script src="https://upload-widget.cloudinary.com/latest/global/all.js"></script>
</head>
<body>

  <!-- HEADER -->
  <header>
    <div class="nav">
      <div class="logo" id="brandLogo">Sharif.com</div>

      <div class="search">
        <input id="searchInput" type="search" placeholder="Search products…" />
        <button class="btn" id="searchBtn">Search</button>
      </div>

      <div class="bar">
        <button class="btn ghost" id="langEn">EN</button>
        <button class="btn ghost" id="langUr">اردو</button>
        <button class="btn" id="openCart">Cart 🛒 <span id="cartCount" class="pill">0</span></button>
        <button class="btn ghost" data-nav="home">Home</button>
        <button class="btn ghost" data-nav="orders">Orders</button>
        <button class="btn ghost" data-nav="settings">Settings</button>
        <button class="btn ghost" data-nav="admin">Admin Panel</button>
        <button class="btn ghost" data-nav="products">Products List</button>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="wrap">

    <!-- CATEGORY TABS -->
    <div class="tabs" id="catTabs"></div>
    <!-- HOME PAGE -->
    <section id="pageHome" class="page active">
      <h2 id="homeTitle">Featured Products</h2>
      <div class="grid" id="productsGrid"></div>
    </section>

    <!-- ORDERS PAGE (local view) -->
    <section id="pageOrders" class="page">
      <h2 id="ordersTitle">Recent Orders (local)</h2>
      <div id="ordersList" class="grid"></div>
      <p class="muted">Note: This shows orders saved in your browser. The full order details are always emailed to you via EmailJS.</p>
    </section>

    <!-- SETTINGS PAGE -->
    <section id="pageSettings" class="page">
      <h2>Store Settings</h2>
      <div class="setgrid">
        <div>
          <label>Brand Name</label>
          <input id="setBrand" value="Sharif.com" />
        </div>
        <div>
          <label>Currency Symbol</label>
          <input id="setCurr" value="₹" />
        </div>
        <div>
          <label>Default Language</label>
          <select id="setLang">
            <option value="en" selected>English</option>
            <option value="ur">اردو</option>
          </select>
        </div>
        <div>
          <label>Enable Cash on Delivery</label>
          <select id="setCOD">
            <option value="on" selected>On</option>
            <option value="off">Off</option>
          </select>
        </div>
        <div style="grid-column:1/-1">
          <label>Store Notice (shows under grid)</label>
          <textarea id="setNotice" rows="3">Free delivery on orders over ₹999.</textarea>
        </div>
      </div>
      <div style="margin-top:12px;display:flex;gap:10px">
        <button class="btn" id="saveSettings">Save Settings</button>
        <button class="btn secondary" id="resetSettings">Reset</button>
      </div>
    </section>

    <!-- ADMIN PANEL PAGE -->
    <section id="pageAdmin" class="page">
      <h2>Add Product</h2>
      <div class="setgrid">
        <div>
          <label>Product Title</label>
          <input id="productTitle" placeholder="Product Title" required />
        </div>
        <div>
          <label>Brand</label>
          <input id="productBrand" placeholder="Brand" required />
        </div>
        <div style="grid-column:1/-1">
          <label>Description</label>
          <textarea id="productDescription" placeholder="Description" required></textarea>
        </div>
        <div>
          <label>Price</label>
          <input id="productPrice" type="number" placeholder="Price" required />
        </div>
        <div style="grid-column:1/-1">
          <button id="upload_widget" class="btn">Upload Image</button>
        </div>
      </div>
      <button class="btn" onclick="addProduct()">Add Product</button>
    </section>

    <!-- PRODUCTS LIST PAGE -->
    <section id="pageProducts" class="page">
      <h2>Products List</h2>
      <div class="grid" id="productsListGrid"></div>
    </section>

  </main>

  <!-- NOTICE -->
  <div class="wrap"><p id="storeNotice" class="muted"></p></div>

  <!-- CART PANEL + ORDER FORM -->
  <aside id="cartPanel">
    <div class="row" style="margin-bottom:8px">
      <h3 id="cartTitle" style="margin:0">Your Cart</h3>
      <button class="btn icon" id="closeCart">✕</button>
    </div>
    <div id="cartItems"></div>
    <div class="row" style="margin-top:10px">
      <div class="price" id="cartTotal">₹0</div>
      <button class="btn danger" id="clearCart">Clear</button>
    </div>

    <hr style="margin:14px 0">

    <h3 id="orderFormTitle" style="margin:6px 0 8px">Delivery Details</h3>
    <form id="orderForm">
      <!-- These names must match your EmailJS template variables -->
      <input type="email" name="user_email" placeholder="Email" required />
      <input type="tel" name="user_phone" placeholder="Phone" required />
      <textarea name="user_address" placeholder="Full Address (Street, City, Zip)" required></textarea>
      <!-- Hidden fields to send cart summary -->
      <input type="hidden" name="order_details" id="order_details">
      <input type="hidden" name="order_total" id="order_total">

      <button class="btn" type="submit" style="width:100%;margin-top:8px" id="placeOrderBtn">Place Order</button>
    </form>

    <p class="muted" style="margin-top:8px" id="codNote">Cash on Delivery available.</p>
  </aside>

  <footer>© <span id="brandFooter">Sharif.com</span> — Built for your business.</footer>

  <!-- EmailJS SDK -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    /************ CONFIG (from you) ************/
    const EMAILJS_SERVICE = 'service_hwvi11g';
    const EMAILJS_TEMPLATE = 'template_kp1zovr';
    const EMAILJS_PUBLIC  = 'DapdU3gPmJ8ymUdD2';

    emailjs.init(EMAILJS_PUBLIC);

    /************ DATA ************/
    const CATEGORIES = ['All','Audio','Accessories','Computers','Mobiles'];

    // Sample products — replace with your real ones
    const PRODUCTS = [
      {id:1,cat:'Audio', title_en:'Microphone X100', title_ur:'مائکروفون X100', price:2500, quality:'Premium metal body', cod:true, image:'https://via.placeholder.com/300x200?text=Mic+X100'},
      {id:2,cat:'Audio', title_en:'Wireless Headphones', title_ur:'وائرلیس ہیڈفون', price:3499, quality:'40h battery, BT 5.3', cod:true, image:'https://via.placeholder.com/300x200?text=Headphones'},
      {id:3,cat:'Accessories', title_en:'USB-C Cable', title_ur:'یو ایس بی سی کیبل', price:299, quality:'1m, fast charge', cod:true, image:'https://via.placeholder.com/300x200?text=USB-C+Cable'},
      {id:4,cat:'Audio', title_en:'Bluetooth Speaker', title_ur:'بلوٹوتھ اسپیکر', price:2199, quality:'10W, splash proof', cod:true, image:'https://via.placeholder.com/300x200?text=Speaker'},
      {id:5,cat:'Computers', title_en:'Laptop Stand', title_ur:'لیپ ٹاپ اسٹینڈ', price:1799, quality:'Aluminium, foldable', cod:true, image:'https://via.placeholder.com/300x200?text=Laptop+Stand'},
      {id:6,cat:'Accessories', title_en:'Gaming Mouse', title_ur:'گیمنگ ماؤس', price:1499, quality:'7 buttons, 12k DPI', cod:true, image:'https://via.placeholder.com/300x200?text=Gaming+Mouse'},
      {id:7,cat:'Accessories', title_en:'Webcam HD', title_ur:'ویب کیم HD', price:2799, quality:'1080p, privacy cover', cod:true, image:'https://via.placeholder.com/300x200?text=Webcam+HD'},
      {id:8,cat:'Mobiles', title_en:'Power Bank 10000', title_ur:'پاور بینک 10000', price:1999, quality:'18W PD', cod:true, image:'https://via.placeholder.com/300x200?text=Power+Bank'}
    ];

    /************ STATE ************/
    let cart = JSON.parse(localStorage.getItem('cart')||'[]');
    let orders = JSON.parse(localStorage.getItem('orders')||'[]');
    let settings = JSON.parse(localStorage.getItem('settings')||'{}');
    let currentLang = settings.lang || 'en';
    let currentCat = 'All';

    /************ DOM ************/
    const brandLogo = document.getElementById('brandLogo');
    const brandFooter = document.getElementById('brandFooter');
    const catTabs = document.getElementById('catTabs');
    const productsGrid = document.getElementById('productsGrid');
    const searchInput = document.getElementById('searchInput');
    const cartPanel = document.getElementById('cartPanel');
    const cartItems = document.getElementById('cartItems');
    const cartCount = document.getElementById('cartCount');
    const cartTotal = document.getElementById('cartTotal');
    const ordersList = document.getElementById('ordersList');
    const storeNotice = document.getElementById('storeNotice');
    const codNote = document.getElementById('codNote');

    // language buttons
    document.getElementById('langEn').onclick = ()=>switchLang('en');
    document.getElementById('langUr').onclick = ()=>switchLang('ur');

    // nav
    document.querySelectorAll('[data-nav]').forEach(b=>{
      b.onclick = ()=>showPage(b.dataset.nav);
    });

    // cart toggles
    document.getElementById('openCart').onclick = ()=>{ cartPanel.style.display='flex'; renderCart(); };
    document.getElementById('closeCart').onclick = ()=>{ cartPanel.style.display='none'; };
    document.getElementById('clearCart').onclick = clearCart;

    // search
    document.getElementById('searchBtn').onclick = renderProducts;
    searchInput.addEventListener('keydown', e=>{ if(e.key==='Enter'){ renderProducts(); }});

    // settings controls
    document.getElementById('saveSettings').onclick = saveSettings;
    document.getElementById('resetSettings').onclick = ()=>{ localStorage.removeItem('settings'); location.reload(); };

    // pages
    function showPage(name){
      document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
      if(name==='home') document.getElementById('pageHome').classList.add('active');
      if(name==='orders'){ document.getElementById('pageOrders').classList.add('active'); renderOrders(); }
      if(name==='settings') { document.getElementById('pageSettings').classList.add('active'); loadSettingsForm(); }
      if(name==='admin') { document.getElementById('pageAdmin').classList.add('active'); }
      if(name==='products') { document.getElementById('pageProducts').classList.add('active'); loadProducts(); }
      window.scrollTo({top:0,behavior:'smooth'});
    }

    /************ RENDER ************/
    function initCategories(){
      catTabs.innerHTML='';
      CATEGORIES.forEach(c=>{
        const a=document.createElement('div');
        a.className='tab'+(c===currentCat?' active':'');
        a.textContent=c;
        a.onclick=()=>{ currentCat=c; document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active')); a.classList.add('active'); renderProducts(); };
        catTabs.appendChild(a);
      });
    }

    function renderProducts(){
      const q = searchInput.value.trim().toLowerCase();
      const curr = settings.curr || '₹';
      productsGrid.innerHTML='';
      PRODUCTS
        .filter(p => currentCat==='All' || p.cat===currentCat)
        .filter(p => (p.title_en+' '+p.title_ur+' '+p.quality).toLowerCase().includes(q))
        .forEach(p=>{
          const title = currentLang==='en' ? p.title_en : p.title_ur;
          const card=document.createElement('div');
          card.className='card';
          card.innerHTML=`
            <img src="${p.image}" alt="${title}">
            <div class="title">${title}</div>
            <div class="muted">${p.quality}</div>
            <div class="price">${curr}${p.price}</div>
            <div class="badges">
              ${ (settings.cod!=='off' && p.cod) ? '<span class="badge">Cash on Delivery</span>' : '' }
              <span class="badge">${p.cat}</span>
            </div>
            <div class="row" style="margin-top:10px">
              <button class="btn" onclick="addToCart(${p.id})">${ currentLang==='en'?'Add to Cart':'کارٹ میں ڈالیں' }</button>
              <button class="btn secondary" onclick="quickBuy(${p.id})">${ currentLang==='en'?'Buy Now':'فوراً خریدیں' }</button>
            </div>
          `;
          productsGrid.appendChild(card);
        });
      // notice
      storeNotice.textContent = settings.notice || 'Free delivery on orders over ₹999.';
    }

    function renderCart(){
      const curr = settings.curr || '₹';
      cartItems.innerHTML='';
      let total=0;
      cart.forEach(ci=>{
        const p=PRODUCTS.find(x=>x.id===ci.id);
        if(!p) return;
        total += p.price*ci.qty;
        const title = currentLang==='en'? p.title_en : p.title_ur;
        const line=document.createElement('div');
        line.className='cart-line';
        line.innerHTML=`
          <img src="${p.image}" alt="${title}">
          <div style="flex:1">
            <div class="title" style="margin:0">${title}</div>
            <div class="muted">${curr}${p.price} × ${ci.qty} = ${curr}${p.price*ci.qty}</div>
            <div class="qty">
              <button class="btn icon" onclick="decrease(${p.id})">−</button>
              <div>${ci.qty}</div>
              <button class="btn icon" onclick="increase(${p.id})">+</button>
              <button class="btn icon" style="margin-left:auto" onclick="removeItem(${p.id})">${ currentLang==='en'?'Remove':'ہٹائیں' }</button>
            </div>
          </div>
        `;
        cartItems.appendChild(line);
      });
      cartTotal.textContent = curr + total;
      cartCount.textContent = cart.reduce((a,b)=>a+b.qty,0);

      // prepare hidden fields for EmailJS
      document.getElementById('order_details').value = cart.map(ci=>{
        const p=PRODUCTS.find(x=>x.id===ci.id); if(!p) return '';
        const title = p.title_en;
        return `${title} x ${ci.qty} = ${curr}${p.price*ci.qty}`;
      }).filter(Boolean).join('\n');
      document.getElementById('order_total').value = curr + total;

      // COD note
      codNote.style.display = (settings.cod!=='off') ? 'block' : 'none';
    }

    function renderOrders(){
      ordersList.innerHTML='';
      if(!orders.length){
        ordersList.innerHTML = '<div class="card"><div>No local orders yet.</div></div>';
        return;
      }
      const curr = settings.curr || '₹';
      orders.forEach(o=>{
        const card=document.createElement('div');
        card.className='card';
        card.innerHTML=`
          <div class="title">Order • ${new Date(o.time).toLocaleString()}</div>
          <div class="muted">${o.email} · ${o.phone}</div>
          <div style="margin:6px 0;white-space:pre-wrap">${o.details}</div>
          <div class="price">${curr}${o.total}</div>
        `;
        ordersList.appendChild(card);
      });
    }

    /************ CART ACTIONS (global for inline handlers) ************/
    window.addToCart = function(id){
      const it = cart.find(x=>x.id===id);
      if(it) it.qty++; else cart.push({id,qty:1});
      persistCart(); renderCart();
    }
    window.quickBuy = function(id){
      addToCart(id);
      cartPanel.style.display='flex';
    }
    window.increase = function(id){ const it=cart.find(x=>x.id===id); if(it){ it.qty++; persistCart(); renderCart(); } }
    window.decrease = function(id){ const it=cart.find(x=>x.id===id); if(it){ it.qty--; if(it.qty<=0) cart=cart.filter(x=>x.id!==id); persistCart(); renderCart(); } }
    window.removeItem = function(id){ cart = cart.filter(x=>x.id!==id); persistCart(); renderCart(); }
    function clearCart(){ if(confirm(currentLang==='en'?'Clear cart?':'کارٹ خالی کریں؟')){ cart=[]; persistCart(); renderCart(); } }
    function persistCart(){ localStorage.setItem('cart', JSON.stringify(cart)); }

    /************ ORDER FORM -> EMAILJS ************/
    document.getElementById('orderForm').addEventListener('submit', async function(e){
      e.preventDefault();
      if(!cart.length){ alert(currentLang==='en'?'Your cart is empty.':'آپ کا کارٹ خالی ہے۔'); return; }

      const form = this;
      const payloadPreview =
        `ORDER SUMMARY\n`+
        `${document.getElementById('order_details').value}\n`+
        `TOTAL: ${document.getElementById('order_total').value}\n\n`+
        `EMAIL: ${form.user_email.value}\nPHONE: ${form.user_phone.value}\nADDRESS: ${form.user_address.value}`;

      // Send via EmailJS
      try{
        await emailjs.sendForm(EMAILJS_SERVICE, EMAILJS_TEMPLATE, form);
        alert(currentLang==='en'?'Order placed! We emailed the details.':'آرڈر ہو گیا! تفصیل ای میل کر دی گئی ہے۔');

        // Save to local "orders" list for your view
        orders.unshift({
          time: Date.now(),
          email: form.user_email.value,
          phone: form.user_phone.value,
          address: form.user_address.value,
          details: document.getElementById('order_details').value,
          total: (document.getElementById('order_total').value || '').replace(/[^\d.]/g,'') || 0
        });
        localStorage.setItem('orders', JSON.stringify(orders));

        form.reset();
        cart=[]; persistCart(); renderCart();
      }catch(err){
        console.error(err);
        alert(currentLang==='en'?'Failed to place order. Check EmailJS IDs & template fields.':'آرڈر نہیں ہو سکا۔ EmailJS سیٹنگ چیک کریں۔');
      }
    });

    /************ SETTINGS ************/
    function loadSettingsForm(){
      document.getElementById('setBrand').value = settings.brand || 'Sharif.com';
      document.getElementById('setCurr').value  = settings.curr  || '₹';
      document.getElementById('setLang').value  = settings.lang  || 'en';
      document.getElementById('setCOD').value   = settings.cod   ?? 'on';
      document.getElementById('setNotice').value= settings.notice || 'Free delivery on orders over ₹999.';
    }
    function saveSettings(){
      settings = {
        brand: document.getElementById('setBrand').value.trim() || 'Sharif.com',
        curr:  document.getElementById('setCurr').value || '₹',
        lang:  document.getElementById('setLang').value || 'en',
        cod:   document.getElementById('setCOD').value,
        notice:document.getElementById('setNotice').value
      };
      localStorage.setItem('settings', JSON.stringify(settings));
      applySettings();
      alert(currentLang==='en'?'Settings saved.':'سیٹنگ محفوظ ہو گئی۔');
    }
    function applySettings(){
      brandLogo.textContent = settings.brand || 'Sharif.com';
      brandFooter.textContent = settings.brand || 'Sharif.com';
      currentLang = settings.lang || 'en';
      if(currentLang==='ur') document.body.style.direction='rtl'; else document.body.style.direction='ltr';
      renderProducts(); renderCart();
      // language toggles visual (optional)
    }

    function switchLang(lang){
      settings.lang = lang;
      localStorage.setItem('settings', JSON.stringify(settings));
      applySettings();
    }

    /************ INIT ************/
    (function init(){
      initCategories();
      applySettings();
      renderProducts();
      renderCart();
      renderOrders();
      // default page home
      showPage('home');
    })();
  </script>
</body>
</html>
